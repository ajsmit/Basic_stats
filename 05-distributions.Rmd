# Distributions


```{r prelim-opts, echo=FALSE}
knitr::opts_chunk$set(
  comment = "R>", 
  warning = FALSE, 
  message = FALSE
)
library(plotly)
```

Therefore, we must next learn about the different types of data distributions we are likely to encounter in the wild.

## Discrete distributions
A discrete random variable has a finite or countable number of possible values. As the name suggests, it models integer data. Below we provide options to generate and visualise data belonging to several classes of discrete distributions. Later (Chapter X) we will learn how to transform these data prior to performing the approapriate statistical analysis.

### Bernoulli distribution
A Bernoulli random variable, $x$, takes the value 1 with probability $p$ and the value 0 with probability $q=1−p$. It is used to represent data resulting from a *single* experiment with binary (yes or no; black or white; positive or negative; success or failure; dead or alive;) outcomes, such as a coin toss---there are only two options, heads or tails. Nothing else. Here, $p$ represents the probability of the one outcome and $q$ the probability of the other outcome. The distribution of the possible outcomes, $x$, is given by:

$$
f(x;p)=
  \begin{cases}
    p, &\text{if}~x=1\\
    1-p, &\text{if}~x=0
  \end{cases}
$$

### Binomial distribution
A binomial random variable, $x$, is the sum of $n$ independent Bernoulli random variables with parameter $p$. This data distribution results from repeating identical experiments that produce a binary outcome with probability $p$ a specified number of times, and choosing $n$ samples at random. As such, it represents a collection of Bernoulli trials.

$$f(x;n,p)= {n\choose x}p^{x}(1-p)^{n-x}$$

### Negative binomial distribution
A negative binomial random variable, $x$, counts the number of successes in a sequence of independent Bernoulli trials with probability $p$ before $r$ failures occur. This distribution could for example be used to predict the number of heads that result from a series of coin tosses before three tails are observed:

$$f(x;n,r,p)= {x+r-1\choose x}p^{x}(1-p)^{r}$$

```{r, echo = FALSE}
# knitr::include_app("https://robert-schlegel.shinyapps.io/binomial_dist/", height = "600px")
```

### Geometric distribution
A geometric random variable, $x$, represents the number of trials that are required to observe a single success. Each trial is independent and has success probability $p$. As an example, the geometric distribution is useful to model the number of times a die must be tossed in order for a six to be observed. It is given by:

$$f(x;p)=(1-p)^{x}p$$

### Poisson distribution
A Poisson random variable, $x$, tallies the number of events occurring in a fixed interval of time or space, given that these events occur with an average rate $\lambda$. Poisson distributions can be used to model events such as meteor showers and or number of people entering a shopping mall. This equation describes the Poison distribution:

$$f(x;\lambda)=\frac{\lambda^{x}e^{-\lambda}}{x!}$$

```{r, echo=FALSE}
# knitr::include_app("https://robert-schlegel.shinyapps.io/poisson_dist/", height = "600px")
```

## Continuous distributions

### Uniform distribution

```{r, echo=FALSE}
# knitr::include_app("https://robert-schlegel.shinyapps.io/uniform_dist/", height = "600px")
```

### Normal distribution

```{r}
# Create base distributions
norm_dat <- data.frame(dist = c(rnorm(10, 10, 1), rnorm(100, 10, 1), rnorm(1000, 10, 1),
                                rnorm(10, 20, 1), rnorm(100, 20, 1), rnorm(1000, 20, 1),
                                rnorm(10, 30, 1), rnorm(100, 30, 1), rnorm(1000, 30, 1),
                                rnorm(10, 10, 2), rnorm(100, 10, 2), rnorm(1000, 10, 2),
                                rnorm(10, 20, 2), rnorm(100, 20, 2), rnorm(1000, 20, 2),
                                rnorm(10, 30, 2), rnorm(100, 30, 2), rnorm(1000, 30, 2),
                                rnorm(10, 10, 3), rnorm(100, 10, 3), rnorm(1000, 10, 3),
                                rnorm(10, 20, 3), rnorm(100, 20, 3), rnorm(1000, 20, 3),
                                rnorm(10, 30, 3), rnorm(100, 30, 3), rnorm(1000, 30, 3)),
                       norm_group = paste(rep(c(rep("n = 10", 10), rep("n = 100", 100), rep("n = 1000", 1000)), 9),
                                      rep(c(rep("m = 10", 1110), rep("m = 20", 1110), rep("m = 30", 1110)), 3),
                                      c(rep("sd = 1", 3330), rep("sd = 2", 3330), rep("sd = 3", 3330))))
# Create density curves
norm_dens <- data.frame()
for(i in 1:length(levels(norm_dat$norm_group))){
  x <- density(norm_dat$dist[norm_dat$norm_group == levels(norm_dat$norm_group)[i]])$x
  y <- density(norm_dat$dist[norm_dat$norm_group == levels(norm_dat$norm_group)[i]])$y
  df <- data.frame(x = x, y = y, norm_group = levels(norm_dat$norm_group)[i])
  norm_dens <- rbind(norm_dens, df)
}

# Create all of the buttons
l <- list()
for(i in 1:length(levels(norm_dat$norm_group))){
  l[[i]] <- list(method = "restyle",
            args = list("transforms[0].value", unique(norm_dat$norm_group)[i]),
            label = unique(norm_dat$norm_group)[i])
}

# Run the figure
p <- plot_ly(data = norm_dat, 
          transforms = list(
            list(type = 'filter',
                 target = ~norm_group,
                 operation = '=',
                 value = unique(norm_dat$norm_group)[1]))) %>%
  add_histogram(x = ~dist, name = "Histogram") %>%
  add_boxplot(x = ~dist, yaxis = "y3", name = "Boxplot") %>% 
  add_trace(data = norm_dens, x = ~x, y = ~y, mode = "lines", fill = "tozeroy", 
            yaxis = "y2", name = "Density",
            transforms = list(
              list(type = 'filter',
                   target = ~norm_group,
                   operation = '=',
                   value = unique(norm_dat$norm_group)[1]))) %>%
  layout(yaxis2 = list(overlaying = "y", zeroline = FALSE,
              showline = FALSE, showticklabels = FALSE, showgrid = FALSE),
         yaxis3 = list(overlaying = "y"),
    updatemenus = list(list(y = 1.2, x = 0.2, buttons = l)))
p
```

```{r PDF, echo = FALSE, fig.margin = TRUE, fig.cap = "Boxplot and probability density function of a normal distribution *N*(0, σ^2^). Credit: [Wikipedia](https://en.wikipedia.org/wiki/Probability_density_function)"}
knitr::include_graphics("figures/Boxplot_vs_PDF.svg")
```

### Student T distribution

```{r, echo=FALSE}
# knitr::include_app("https://robert-schlegel.shinyapps.io/student_t_dist/", height = "600px")
```

### Chi-squared distribution

```{r, echo=FALSE}
# knitr::include_app("https://robert-schlegel.shinyapps.io/chi_squared_dist/", height = "600px")
```

### Exponential distribution

```{r, echo=FALSE}
# knitr::include_app("https://robert-schlegel.shinyapps.io/exponential_dist/", height = "600px")
```

### F distribution

```{r, echo=FALSE}
# knitr::include_app("https://robert-schlegel.shinyapps.io/f_dist/", height = "600px")
```

### Gamma distribution

### Beta distribution
