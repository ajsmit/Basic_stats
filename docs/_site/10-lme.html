<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=03751ccfa51e97b314a4c01a87a9b1b5598c90c5" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Linear mixed models | Basic_stats</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Linear mixed models" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Basic Statistics Workshop" />
<meta property="og:description" content="Basic Statistics Workshop" />
<link rel="canonical" href="http://localhost:4000/10-lme.html" />
<meta property="og:url" content="http://localhost:4000/10-lme.html" />
<meta property="og:site_name" content="Basic_stats" />
<script type="application/ld+json">
{"url":"http://localhost:4000/10-lme.html","headline":"Linear mixed models","description":"Basic Statistics Workshop","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="http://localhost:4000/">
          <h1>Basic_stats</h1>
        </a>
        <h2>Basic Statistics Workshop</h2>
        
          <a href="http://github.com/ajsmit/Basic_stats" class="button"><small>View project on</small> GitHub</a>
        
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1 id="linear-mixed-models">Linear mixed models</h1>

<p>In the previous chapter we learned how to test hypotheses based on the comparions of means between sets of data when we were able to meet our two base assumptions. These parametric tests are preferred over non-parametric tests because they are more robust. However, when we simply aren’t able to meet these assumptions we must not despair. Non-parametric tests are still useful. In this chapter we will learn how to run non-parametirc tests for two sample and multiple sample datasets. To start, let’s load our libraries and <code class="highlighter-rouge">chicks</code> data if we have not already.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First activate libraries</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggpubr</span><span class="p">)</span><span class="w">

</span><span class="c1"># Then load data</span><span class="w">
</span><span class="n">chicks</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as_tibble</span><span class="p">(</span><span class="n">ChickWeight</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>With our libraries and data loaded, let’s find a day in which at least one of our assumptions are violated.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Then check for failing assumptions</span><span class="w">
</span><span class="n">chicks</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">Diet</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">norm_wt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">shapiro.test</span><span class="p">(</span><span class="n">weight</span><span class="p">)[</span><span class="m">2</span><span class="p">]),</span><span class="w">
            </span><span class="n">var_wt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="n">weight</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>R&gt; # A tibble: 4 x 3
R&gt;   Diet  norm_wt var_wt
R&gt;   &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;
R&gt; 1 1     0.0138   0.989
R&gt; 2 2     0.138    2.23 
R&gt; 3 3     0.00527  1.07 
R&gt; 4 4     0.0739   1.11
</code></pre></div></div>

<h2 id="wilcox-rank-sum-test">Wilcox rank sum test</h2>

<p>The non-parametric version of a t-test is a Wilcox rank sum test. To perform this test in R we may again use <code class="highlighter-rouge">compare_means()</code> and specify the test we want:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">compare_means</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Diet</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">chicks</span><span class="p">,</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">Diet</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)),</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"wilcox.test"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>R&gt; # A tibble: 1 x 8
R&gt;   .y.    group1 group2     p p.adj p.format p.signif method  
R&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   
R&gt; 1 weight 1      2      0.235 0.235 0.23     ns       Wilcoxon
</code></pre></div></div>

<p>What do our results show?</p>

<h2 id="kruskall-wallis-rank-sum-test">Kruskall-Wallis rank sum test</h2>

<h3 id="single-factor">Single factor</h3>

<p>The non-parametric version of an ANOVA is a Kruskall-Wallis rank sum test. As you may have by now surmised, this may be done with <code class="highlighter-rouge">compare_means()</code> as seen below:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">compare_means</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Diet</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">chicks</span><span class="p">,</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"kruskal.test"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>R&gt; # A tibble: 1 x 6
R&gt;   .y.        p p.adj p.format p.signif method        
R&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;         
R&gt; 1 weight 0.475 0.475 0.48     ns       Kruskal-Wallis
</code></pre></div></div>

<p>As with the ANOVA, this first step with the Kruskall-Wallis test is not the last. We must again run a post-hoc test on our results. This time we will need to use <code class="highlighter-rouge">pgirmess::kruskalmc()</code>, which means we will need to load a new library.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">pgirmess</span><span class="p">)</span><span class="w">

</span><span class="n">kruskalmc</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Diet</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">chicks</span><span class="p">,</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>R&gt; Multiple comparison test after Kruskal-Wallis 
R&gt; p.value: 0.05 
R&gt; Comparisons
R&gt;     obs.dif critical.dif difference
R&gt; 1-2    6.95     14.89506      FALSE
R&gt; 1-3    6.90     14.89506      FALSE
R&gt; 1-4    4.15     14.89506      FALSE
R&gt; 2-3    0.05     17.19933      FALSE
R&gt; 2-4    2.80     17.19933      FALSE
R&gt; 3-4    2.75     17.19933      FALSE
</code></pre></div></div>

<p>Let’s consult the help file for <code class="highlighter-rouge">kruskalmc()</code> to understand what this print-out means.</p>

<h3 id="multiple-factors">Multiple factors</h3>

<p>The water becomes murky quickly when one wants to perform mutliple factor non-parametric comparison of means tests. TO that end, we will not cover the few existing methods here. Rather, one should avoid the necessity for these types of tests when designing an experiment.</p>

<h2 id="exercises">Exercises</h2>

<h2 id="exercise-1">Exercise 1</h2>

<p>Write out the hypotheses that we tested for in this chapter and answer them based on the results we produced in class.</p>

        </section>

        <aside id="sidebar">
          

          
            <p class="repo-owner"><a href="http://github.com/ajsmit/Basic_stats">Basic_stats</a> is maintained by <a href="http://github.com/ajsmit">ajsmit</a>.</p>
          

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>
        </aside>
      </div>
    </div>

    
  </body>
</html>
