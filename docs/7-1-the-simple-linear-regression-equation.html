<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="7.1 The simple linear regression equation | Basic Statistics" />
<meta property="og:type" content="book" />

<meta property="og:image" content="/figures/NSFW.jpg" />
<meta property="og:description" content="A Book about Basic Statistics." />
<meta name="github-repo" content="ajsmit/Basic_stats" />

<meta name="author" content="AJ Smit and Robert Schlegel" />

<meta name="date" content="2021-06-19" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="A Book about Basic Statistics.">

<title>7.1 The simple linear regression equation | Basic Statistics</title>

<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#preface">Preface</a></li>
<li><a href="prerequisites.html#prerequisites">Prerequisites</a></li>
<li><a href="1-introduction.html#introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="1-1-venue-date-and-time.html#venue-date-and-time"><span class="toc-section-number">1.1</span> Venue, date and time</a></li>
<li><a href="1-2-course-outline.html#course-outline"><span class="toc-section-number">1.2</span> Course outline</a></li>
<li><a href="1-3-about-this-workshop.html#about-this-workshop"><span class="toc-section-number">1.3</span> About this Workshop</a></li>
<li><a href="1-4-this-is-biology-why-more-r-coding.html#this-is-biology-why-more-r-coding"><span class="toc-section-number">1.4</span> This is biology: why more R coding?</a></li>
<li><a href="1-5-installing-r-and-rstudio.html#installing-r-and-rstudio"><span class="toc-section-number">1.5</span> Installing R and RStudio</a></li>
<li><a href="1-6-resources.html#resources"><span class="toc-section-number">1.6</span> Resources</a></li>
<li><a href="1-7-style-and-code-conventions.html#style-and-code-conventions"><span class="toc-section-number">1.7</span> Style and code conventions</a></li>
<li><a href="1-8-assessment-and-teaching-philosophy.html#assessment-and-teaching-philosophy"><span class="toc-section-number">1.8</span> Assessment and teaching philosophy</a></li>
<li><a href="1-9-about-this-document.html#about-this-document"><span class="toc-section-number">1.9</span> About this document</a></li>
</ul></li>
<li><a href="2-types-of-data.html#types-of-data"><span class="toc-section-number">2</span> Types of data</a>
<ul>
<li><a href="2-1-data-classes.html#data-classes"><span class="toc-section-number">2.1</span> Data classes</a>
<ul>
<li><a href="2-1-data-classes.html#numerical-data"><span class="toc-section-number">2.1.1</span> Numerical data</a></li>
<li><a href="2-1-data-classes.html#qualitative-data"><span class="toc-section-number">2.1.2</span> Qualitative data</a></li>
<li><a href="2-1-data-classes.html#binary-data"><span class="toc-section-number">2.1.3</span> Binary data</a></li>
<li><a href="2-1-data-classes.html#character-values"><span class="toc-section-number">2.1.4</span> Character values</a></li>
<li><a href="2-1-data-classes.html#missing-values"><span class="toc-section-number">2.1.5</span> Missing values</a></li>
<li><a href="2-1-data-classes.html#complex-numbers"><span class="toc-section-number">2.1.6</span> Complex numbers</a></li>
</ul></li>
<li><a href="2-2-viewing-our-data.html#viewing-our-data"><span class="toc-section-number">2.2</span> Viewing our data</a>
<ul>
<li><a href="2-2-viewing-our-data.html#from-the-environment-pane"><span class="toc-section-number">2.2.1</span> From the Environment pane</a></li>
<li><a href="2-2-viewing-our-data.html#head-and-tail"><span class="toc-section-number">2.2.2</span> <code>head()</code> and <code>tail()</code></a></li>
<li><a href="2-2-viewing-our-data.html#colnames"><span class="toc-section-number">2.2.3</span> <code>colnames()</code></a></li>
<li><a href="2-2-viewing-our-data.html#summary"><span class="toc-section-number">2.2.4</span> <code>summary()</code></a></li>
</ul></li>
</ul></li>
<li><a href="3-descriptive-statistics-central-tendency-and-dispersion.html#descriptive-statistics-central-tendency-and-dispersion"><span class="toc-section-number">3</span> Descriptive statistics: central tendency and dispersion</a>
<ul>
<li><a href="3-1-samples-and-populations.html#samples-and-populations"><span class="toc-section-number">3.1</span> Samples and populations</a></li>
<li><a href="3-2-measures-of-central-tendency.html#measures-of-central-tendency"><span class="toc-section-number">3.2</span> Measures of central tendency</a>
<ul>
<li><a href="3-2-measures-of-central-tendency.html#the-mean"><span class="toc-section-number">3.2.1</span> The mean</a></li>
<li><a href="3-2-measures-of-central-tendency.html#the-median"><span class="toc-section-number">3.2.2</span> The median</a></li>
<li><a href="3-2-measures-of-central-tendency.html#skewness"><span class="toc-section-number">3.2.3</span> Skewness</a></li>
<li><a href="3-2-measures-of-central-tendency.html#kurtosis"><span class="toc-section-number">3.2.4</span> Kurtosis</a></li>
</ul></li>
<li><a href="3-3-measures-of-variation-and-spread.html#measures-of-variation-and-spread"><span class="toc-section-number">3.3</span> Measures of variation and spread</a>
<ul>
<li><a href="3-3-measures-of-variation-and-spread.html#the-variance-and-standard-deviation"><span class="toc-section-number">3.3.1</span> The variance and standard deviation</a></li>
<li><a href="3-3-measures-of-variation-and-spread.html#quantiles"><span class="toc-section-number">3.3.2</span> Quantiles</a></li>
<li><a href="3-3-measures-of-variation-and-spread.html#the-minimum-maximum-and-range"><span class="toc-section-number">3.3.3</span> The minimum, maximum and range</a></li>
<li><a href="3-3-measures-of-variation-and-spread.html#covariance"><span class="toc-section-number">3.3.4</span> Covariance</a></li>
<li><a href="3-3-measures-of-variation-and-spread.html#correlation"><span class="toc-section-number">3.3.5</span> Correlation</a></li>
</ul></li>
<li><a href="3-4-missing-values-1.html#missing-values-1"><span class="toc-section-number">3.4</span> Missing values</a></li>
<li><a href="3-5-descriptive-statistics-by-group.html#descriptive-statistics-by-group"><span class="toc-section-number">3.5</span> Descriptive statistics by group</a>
<ul>
<li><a href="3-5-descriptive-statistics-by-group.html#groupwise-summary-statistics"><span class="toc-section-number">3.5.1</span> Groupwise summary statistics</a></li>
<li><a href="3-5-descriptive-statistics-by-group.html#displays-of-group-summaries"><span class="toc-section-number">3.5.2</span> Displays of group summaries</a></li>
</ul></li>
<li><a href="3-6-exercises.html#exercises"><span class="toc-section-number">3.6</span> Exercises</a>
<ul>
<li><a href="3-6-exercises.html#exercise-1"><span class="toc-section-number">3.6.1</span> Exercise 1</a></li>
</ul></li>
</ul></li>
<li><a href="4-graphical-data-displays.html#graphical-data-displays"><span class="toc-section-number">4</span> Graphical data displays</a>
<ul>
<li><a href="4-1-qualitative-data-1.html#qualitative-data-1"><span class="toc-section-number">4.1</span> Qualitative data</a></li>
<li><a href="4-2-continuous-data-1.html#continuous-data-1"><span class="toc-section-number">4.2</span> Continuous data</a>
<ul>
<li><a href="4-2-continuous-data-1.html#frequency-distributions-histograms"><span class="toc-section-number">4.2.1</span> Frequency distributions (histograms)</a></li>
<li><a href="4-2-continuous-data-1.html#box-plots"><span class="toc-section-number">4.2.2</span> Box plots</a></li>
<li><a href="4-2-continuous-data-1.html#pairwise-scatter-plots"><span class="toc-section-number">4.2.3</span> Pairwise Scatter plots</a></li>
<li><a href="4-2-continuous-data-1.html#bar-graphs"><span class="toc-section-number">4.2.4</span> Bar graphs</a></li>
<li><a href="4-2-continuous-data-1.html#density-graphs"><span class="toc-section-number">4.2.5</span> Density graphs</a></li>
<li><a href="4-2-continuous-data-1.html#violin-plots"><span class="toc-section-number">4.2.6</span> Violin plots</a></li>
</ul></li>
<li><a href="4-3-exercises-1.html#exercises-1"><span class="toc-section-number">4.3</span> Exercises</a>
<ul>
<li><a href="4-3-exercises-1.html#exercise-1-1"><span class="toc-section-number">4.3.1</span> Exercise 1</a></li>
</ul></li>
</ul></li>
<li><a href="5-inferences-about-one-or-two-populations.html#inferences-about-one-or-two-populations"><span class="toc-section-number">5</span> Inferences about one or two populations</a>
<ul>
<li><a href="5-1-what-are-probabilities.html#what-are-probabilities"><span class="toc-section-number">5.1</span> What are probabilities?</a></li>
<li><a href="5-2-is-there-a-difference-between-two-groups.html#is-there-a-difference-between-two-groups"><span class="toc-section-number">5.2</span> Is there a difference between two groups?</a></li>
<li><a href="5-3-assumptions.html#assumptions"><span class="toc-section-number">5.3</span> Assumptions</a>
<ul>
<li><a href="5-3-assumptions.html#normality"><span class="toc-section-number">5.3.1</span> Normality</a></li>
<li><a href="5-3-assumptions.html#homoscedasticity"><span class="toc-section-number">5.3.2</span> Homoscedasticity</a></li>
<li><a href="5-3-assumptions.html#two-for-one"><span class="toc-section-number">5.3.3</span> Two for one</a></li>
</ul></li>
<li><a href="5-4-one-sample-t-tests.html#one-sample-t-tests"><span class="toc-section-number">5.4</span> One-sample <em>t</em>-tests</a>
<ul>
<li><a href="5-4-one-sample-t-tests.html#one-sided-one-sample-t-tests"><span class="toc-section-number">5.4.1</span> One-sided one-sample <em>t</em>-tests</a></li>
<li><a href="5-4-one-sample-t-tests.html#two-sided-one-sample-t-tests"><span class="toc-section-number">5.4.2</span> Two-sided one-sample <em>t</em>-tests</a></li>
</ul></li>
<li><a href="5-5-two-sample-t-tests.html#two-sample-t-tests"><span class="toc-section-number">5.5</span> Two-sample <em>t</em>-tests</a>
<ul>
<li><a href="5-5-two-sample-t-tests.html#one-sided-two-sample-t-tests"><span class="toc-section-number">5.5.1</span> One-sided two-sample <em>t</em>-tests</a></li>
<li><a href="5-5-two-sample-t-tests.html#two-sided-two-sample-t-tests"><span class="toc-section-number">5.5.2</span> Two-sided two-sample <em>t</em>-tests</a></li>
</ul></li>
<li><a href="5-6-paired-t-tests.html#paired-t-tests"><span class="toc-section-number">5.6</span> Paired <em>t</em>-tests</a></li>
<li><a href="5-7-comparison-of-two-population-proportions.html#comparison-of-two-population-proportions"><span class="toc-section-number">5.7</span> Comparison of two population proportions</a>
<ul>
<li><a href="5-7-comparison-of-two-population-proportions.html#one-sample-and-two-sample-tests"><span class="toc-section-number">5.7.1</span> One-sample and two-sample tests</a></li>
<li><a href="5-7-comparison-of-two-population-proportions.html#one-sided-and-two-sided-tests"><span class="toc-section-number">5.7.2</span> One-sided and two-sided tests</a></li>
</ul></li>
<li><a href="5-8-a-t-test-workflow.html#a-t-test-workflow"><span class="toc-section-number">5.8</span> A <em>t</em>-test workflow</a>
<ul>
<li><a href="5-8-a-t-test-workflow.html#loading-data"><span class="toc-section-number">5.8.1</span> Loading data</a></li>
<li><a href="5-8-a-t-test-workflow.html#visualising-data"><span class="toc-section-number">5.8.2</span> Visualising data</a></li>
<li><a href="5-8-a-t-test-workflow.html#formulating-a-hypothesis"><span class="toc-section-number">5.8.3</span> Formulating a hypothesis</a></li>
<li><a href="5-8-a-t-test-workflow.html#choosing-a-test"><span class="toc-section-number">5.8.4</span> Choosing a test</a></li>
<li><a href="5-8-a-t-test-workflow.html#checking-assumptions"><span class="toc-section-number">5.8.5</span> Checking assumptions</a></li>
<li><a href="5-8-a-t-test-workflow.html#running-an-analysis"><span class="toc-section-number">5.8.6</span> Running an analysis</a></li>
<li><a href="5-8-a-t-test-workflow.html#interpreting-the-results"><span class="toc-section-number">5.8.7</span> Interpreting the results</a></li>
<li><a href="5-8-a-t-test-workflow.html#drawing-conclusions"><span class="toc-section-number">5.8.8</span> Drawing conclusions</a></li>
<li><a href="5-8-a-t-test-workflow.html#going-further"><span class="toc-section-number">5.8.9</span> Going further</a></li>
</ul></li>
<li><a href="5-9-exercises-2.html#exercises-2"><span class="toc-section-number">5.9</span> Exercises</a>
<ul>
<li><a href="5-9-exercises-2.html#exercise-1-2"><span class="toc-section-number">5.9.1</span> Exercise 1</a></li>
<li><a href="5-9-exercises-2.html#exercise-2"><span class="toc-section-number">5.9.2</span> Exercise 2</a></li>
</ul></li>
</ul></li>
<li><a href="6-anova.html#anova"><span class="toc-section-number">6</span> ANOVA</a>
<ul>
<li><a href="6-1-remember-the-t-test.html#remember-the-t-test"><span class="toc-section-number">6.1</span> Remember the <em>t</em>-test</a></li>
<li><a href="6-2-anova-1.html#anova-1"><span class="toc-section-number">6.2</span> ANOVA</a>
<ul>
<li><a href="6-2-anova-1.html#single-factor"><span class="toc-section-number">6.2.1</span> Single factor</a></li>
<li><a href="6-2-anova-1.html#multiple-factors"><span class="toc-section-number">6.2.2</span> Multiple factors</a></li>
<li><a href="6-2-anova-1.html#examples"><span class="toc-section-number">6.2.3</span> Examples</a></li>
</ul></li>
<li><a href="6-3-alternatives-to-anova.html#alternatives-to-anova"><span class="toc-section-number">6.3</span> Alternatives to ANOVA</a>
<ul>
<li><a href="6-3-alternatives-to-anova.html#wilcox-rank-sum-test"><span class="toc-section-number">6.3.1</span> Wilcox rank sum test</a></li>
<li><a href="6-3-alternatives-to-anova.html#kruskall-wallis-rank-sum-test"><span class="toc-section-number">6.3.2</span> Kruskall-Wallis rank sum test</a></li>
<li><a href="6-3-alternatives-to-anova.html#the-sa-time-data"><span class="toc-section-number">6.3.3</span> The SA time data</a></li>
</ul></li>
<li><a href="6-4-exercises-3.html#exercises-3"><span class="toc-section-number">6.4</span> Exercises</a>
<ul>
<li><a href="6-4-exercises-3.html#exercise-1-3"><span class="toc-section-number">6.4.1</span> Exercise 1</a></li>
<li><a href="6-4-exercises-3.html#exercise-2-1"><span class="toc-section-number">6.4.2</span> Exercise 2</a></li>
<li><a href="6-4-exercises-3.html#exercise-3"><span class="toc-section-number">6.4.3</span> Exercise 3</a></li>
</ul></li>
</ul></li>
<li><a href="7-simple-linear-regressions.html#simple-linear-regressions"><span class="toc-section-number">7</span> Simple linear regressions</a>
<ul>
<li><a href="7-1-the-simple-linear-regression-equation.html#the-simple-linear-regression-equation"><span class="toc-section-number">7.1</span> The simple linear regression equation</a>
<ul>
<li><a href="7-1-the-simple-linear-regression-equation.html#the-intercept"><span class="toc-section-number">7.1.1</span> The intercept</a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#the-regression-coefficient"><span class="toc-section-number">7.1.2</span> The regression coefficient</a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#a-graph-of-the-linear-regression"><span class="toc-section-number">7.1.3</span> A graph of the linear regression</a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#predicting-from-the-linear-model"><span class="toc-section-number">7.1.4</span> Predicting from the linear model</a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#the-coefficient-of-determination-r2"><span class="toc-section-number">7.1.5</span> The coefficient of determination, <span class="math inline">\(r^{2}\)</span></a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#significance-test-for-linear-regression"><span class="toc-section-number">7.1.6</span> Significance test for linear regression</a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#confidence-interval-for-linear-regression"><span class="toc-section-number">7.1.7</span> Confidence interval for linear regression</a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#prediction-interval-for-linear-regression"><span class="toc-section-number">7.1.8</span> Prediction interval for linear regression</a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#residual-plot"><span class="toc-section-number">7.1.9</span> Residual plot</a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#standardised-residual"><span class="toc-section-number">7.1.10</span> Standardised residual</a></li>
<li><a href="7-1-the-simple-linear-regression-equation.html#normal-probability-plot-of-residuals"><span class="toc-section-number">7.1.11</span> Normal probability plot of residuals</a></li>
</ul></li>
<li><a href="7-2-using-an-additional-categorical-variable.html#using-an-additional-categorical-variable"><span class="toc-section-number">7.2</span> Using an additional categorical variable</a></li>
</ul></li>
<li><a href="8-correlations.html#correlations"><span class="toc-section-number">8</span> Correlations</a>
<ul>
<li><a href="8-1-pearson-correlation.html#pearson-correlation"><span class="toc-section-number">8.1</span> Pearson correlation</a></li>
<li><a href="8-2-spearman-rank-correlation.html#spearman-rank-correlation"><span class="toc-section-number">8.2</span> Spearman rank correlation</a></li>
<li><a href="8-3-kendall-rank-correlation.html#kendall-rank-correlation"><span class="toc-section-number">8.3</span> Kendall rank correlation</a></li>
<li><a href="8-4-one-panel-visual.html#one-panel-visual"><span class="toc-section-number">8.4</span> One panel visual</a></li>
<li><a href="8-5-multiple-panel-visual.html#multiple-panel-visual"><span class="toc-section-number">8.5</span> Multiple panel visual</a></li>
<li><a href="8-6-exercises-4.html#exercises-4"><span class="toc-section-number">8.6</span> Exercises</a>
<ul>
<li><a href="8-6-exercises-4.html#exercise-1-4"><span class="toc-section-number">8.6.1</span> Exercise 1</a></li>
</ul></li>
</ul></li>
<li><a href="9-confidence-intervals.html#confidence-intervals"><span class="toc-section-number">9</span> Confidence intervals</a>
<ul>
<li><a href="9-1-calculating-confidence.html#calculating-confidence"><span class="toc-section-number">9.1</span> Calculating confidence</a></li>
<li><a href="9-2-ci-of-compared-means.html#ci-of-compared-means"><span class="toc-section-number">9.2</span> CI of compared means</a></li>
<li><a href="9-3-harrell-plots.html#harrell-plots"><span class="toc-section-number">9.3</span> Harrell plots</a></li>
<li><a href="9-4-exercises-5.html#exercises-5"><span class="toc-section-number">9.4</span> Exercises</a>
<ul>
<li><a href="9-4-exercises-5.html#exercise-1-5"><span class="toc-section-number">9.4.1</span> Exercise 1</a></li>
<li><a href="9-4-exercises-5.html#exercise-2-2"><span class="toc-section-number">9.4.2</span> Exercise 2</a></li>
</ul></li>
</ul></li>
<li><a href="10-testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data"><span class="toc-section-number">10</span> Testing assumptions or: How I learned to stop worrying and transform the data</a>
<ul>
<li><a href="10-1-backgroud.html#backgroud"><span class="toc-section-number">10.1</span> Backgroud</a>
<ul>
<li><a href="10-1-backgroud.html#normality-1"><span class="toc-section-number">10.1.1</span> Normality</a></li>
<li><a href="10-1-backgroud.html#homoscedasticity-1"><span class="toc-section-number">10.1.2</span> Homoscedasticity</a></li>
<li><a href="10-1-backgroud.html#epic-fail.-now-what"><span class="toc-section-number">10.1.3</span> Epic fail. Now what?</a></li>
</ul></li>
<li><a href="10-2-transforming-data.html#transforming-data"><span class="toc-section-number">10.2</span> Transforming data</a>
<ul>
<li><a href="10-2-transforming-data.html#log-transform"><span class="toc-section-number">10.2.1</span> Log transform</a></li>
<li><a href="10-2-transforming-data.html#arcsine-transform"><span class="toc-section-number">10.2.2</span> Arcsine transform</a></li>
<li><a href="10-2-transforming-data.html#cube-root"><span class="toc-section-number">10.2.3</span> Cube root</a></li>
<li><a href="10-2-transforming-data.html#square-root-transform"><span class="toc-section-number">10.2.4</span> Square root transform</a></li>
</ul></li>
<li><a href="10-3-exercises-6.html#exercises-6"><span class="toc-section-number">10.3</span> Exercises</a>
<ul>
<li><a href="10-3-exercises-6.html#exercise-1-6"><span class="toc-section-number">10.3.1</span> Exercise 1</a></li>
<li><a href="10-3-exercises-6.html#exercise-2-3"><span class="toc-section-number">10.3.2</span> Exercise 2</a></li>
</ul></li>
</ul></li>
<li><a href="11-linear-mixed-models.html#linear-mixed-models"><span class="toc-section-number">11</span> Linear mixed models</a>
<ul>
<li><a href="11-1-wilcox-rank-sum-test-1.html#wilcox-rank-sum-test-1"><span class="toc-section-number">11.1</span> Wilcox rank sum test</a></li>
<li><a href="11-2-kruskall-wallis-rank-sum-test-1.html#kruskall-wallis-rank-sum-test-1"><span class="toc-section-number">11.2</span> Kruskall-Wallis rank sum test</a>
<ul>
<li><a href="11-2-kruskall-wallis-rank-sum-test-1.html#single-factor-2"><span class="toc-section-number">11.2.1</span> Single factor</a></li>
<li><a href="11-2-kruskall-wallis-rank-sum-test-1.html#multiple-factors-2"><span class="toc-section-number">11.2.2</span> Multiple factors</a></li>
</ul></li>
<li><a href="11-3-generalised-linear-models.html#generalised-linear-models"><span class="toc-section-number">11.3</span> Generalised linear models</a>
<ul>
<li><a href="11-3-generalised-linear-models.html#sign-test"><span class="toc-section-number">11.3.1</span> Sign Test</a></li>
<li><a href="11-3-generalised-linear-models.html#wilcoxon-signed-rank-test"><span class="toc-section-number">11.3.2</span> Wilcoxon Signed-Rank Test</a></li>
<li><a href="11-3-generalised-linear-models.html#mann-whitney-wilcoxon-test"><span class="toc-section-number">11.3.3</span> Mann-Whitney-Wilcoxon Test</a></li>
<li><a href="11-3-generalised-linear-models.html#kruskal-wallis-test"><span class="toc-section-number">11.3.4</span> Kruskal-Wallis Test</a></li>
<li><a href="11-3-generalised-linear-models.html#generalised-linear-models-glm"><span class="toc-section-number">11.3.5</span> Generalised linear models (GLM)</a></li>
</ul></li>
<li><a href="11-4-exercises-7.html#exercises-7"><span class="toc-section-number">11.4</span> Exercises</a></li>
<li><a href="11-5-exercise-1-7.html#exercise-1-7"><span class="toc-section-number">11.5</span> Exercise 1</a></li>
</ul></li>
<li><a href="12-chi-squared.html#chi-squared"><span class="toc-section-number">12</span> Chi-squared</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="the-simple-linear-regression-equation" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> The simple linear regression equation</h2>
<p>The linear regression equation is already known to you. It is:</p>
<p><span class="math display">\[y_{n}=\beta \cdot x_{n}+\alpha+\epsilon\]</span></p>
<p>Coefficients are parameters (statistics) that describe two properties of the linear line that best fit a scatter plot between a dependent variable and the independent variable. The dependent variable, <span class="math inline">\(y_{1..n}\)</span>, may also be called the response variable, and the independent variable, <span class="math inline">\(x_{1..n}\)</span>, the predictor. The regression model consists of an <em>intercept term</em>, <span class="math inline">\(\alpha\)</span>, that describes where the fitted line starts and intercepts with the <em>y</em>-axis, and the <em>slope</em>, <span class="math inline">\(\beta\)</span>, of the line. The amount of variation not explained by a linear relationship of <span class="math inline">\(y\)</span> on <span class="math inline">\(x\)</span> is termed the residual variation, or simply the residual or the error term, and in the above equation it is indicated by <span class="math inline">\(\epsilon\)</span>.</p>
<p>The regression parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are determined by <em>minimising the error sum of squares</em> of the error term, <span class="math inline">\(\epsilon\)</span>. It allows us to predict new fitted values of <span class="math inline">\(y\)</span> based on values of <span class="math inline">\(x\)</span>. The error sum of squares is calculated by:</p>
<p><span class="math display">\[error~SS=\sum_{i=1}^{n}(y_{i}-\hat{y}_{i})^{2}\]</span></p>
<p>To see an animation demonstrating this click <a href="https://raw.githubusercontent.com/ajsmit/Basic_stats/master/figures/lm_rotate.avi">here</a>.</p>
<p>We will demonstrate the principle behind a simple linear regression by using the built-in dataset <code>faithful</code>. According to the R help file for the data, the dataset describes the “Waiting time between eruptions and the duration of the eruption for the Old Faithful geyser in Yellowstone National Park, Wyoming, USA.”</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="7-1-the-simple-linear-regression-equation.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(faithful)</span></code></pre></div>
<pre><code>R&gt;   eruptions waiting
R&gt; 1     3.600      79
R&gt; 2     1.800      54
R&gt; 3     3.333      74
R&gt; 4     2.283      62
R&gt; 5     4.533      85
R&gt; 6     2.883      55</code></pre>
<p>In this dataset there are two columns: the first, <code>eruptions</code>, denotes the duration of the eruption (in minutes), and the second, <code>waiting</code>, is the waiting time (also in minutes) until the next eruptions. Its linear regression model can be expressed as:</p>
<p><span class="math display">\[eruption_{n}=\beta \cdot waiting_{n}+\alpha+\epsilon\]</span></p>
<p>Here we fit the model in R. When we perform a linear regression in R, it will output the model and the coefficients:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="7-1-the-simple-linear-regression-equation.html#cb182-1" aria-hidden="true" tabindex="-1"></a>eruption.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(eruptions <span class="sc">~</span> waiting, <span class="at">data =</span> faithful)</span>
<span id="cb182-2"><a href="7-1-the-simple-linear-regression-equation.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(eruption.lm)</span></code></pre></div>
<pre><code>R&gt; 
R&gt; Call:
R&gt; lm(formula = eruptions ~ waiting, data = faithful)
R&gt; 
R&gt; Residuals:
R&gt;      Min       1Q   Median       3Q      Max 
R&gt; -1.29917 -0.37689  0.03508  0.34909  1.19329 
R&gt; 
R&gt; Coefficients:
R&gt;              Estimate Std. Error t value Pr(&gt;|t|)    
R&gt; (Intercept) -1.874016   0.160143  -11.70   &lt;2e-16 ***
R&gt; waiting      0.075628   0.002219   34.09   &lt;2e-16 ***
R&gt; ---
R&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
R&gt; 
R&gt; Residual standard error: 0.4965 on 270 degrees of freedom
R&gt; Multiple R-squared:  0.8115, Adjusted R-squared:  0.8108 
R&gt; F-statistic:  1162 on 1 and 270 DF,  p-value: &lt; 2.2e-16</code></pre>
<div id="the-intercept" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> The intercept</h3>
<p>The intercept is the best estimate of the starting point of the fitted line on the lefthand side of the graph. You will notice that there is also an estimate for the standard error of the estimate for the intercept.</p>
</div>
<div id="the-regression-coefficient" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> The regression coefficient</h3>
<p>The interpretation of the regression coefficient is simple. For every one unit of change in the independent variable (here waiting time) there is a corresponding change in the dependent variable (here the duration of the eruption). This is the <em>slope</em> or <em>gradient</em>, and it may be positive or negative. In the example the coefficient of determination of the line is denoted by the value 0.076 min.min<sup>-1</sup> in the column termed <code>Estimate</code> and in the row called <code>waiting</code> (the latter name will of course depend on the name of the response column in your dataset). The coefficient of determination multiplies the response variable to produce a prediction of the response based on the slope of the relationship between the response and the predictor. It tells us how much one unit in change of the independent variable <em>determines</em> the corresponding change in the response variable. There is also a standard error for the estimate.</p>
</div>
<div id="a-graph-of-the-linear-regression" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> A graph of the linear regression</h3>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="7-1-the-simple-linear-regression-equation.html#cb184-1" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">round</span>(eruption.lm<span class="sc">$</span>coef[<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb184-2"><a href="7-1-the-simple-linear-regression-equation.html#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p.val &lt;- round(coefficients(summary(eruption.lm))[2, 4], 3) # it approx. 0, so...</span></span>
<span id="cb184-3"><a href="7-1-the-simple-linear-regression-equation.html#cb184-3" aria-hidden="true" tabindex="-1"></a>p.val <span class="ot">=</span> <span class="fl">0.001</span></span>
<span id="cb184-4"><a href="7-1-the-simple-linear-regression-equation.html#cb184-4" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">summary</span>(eruption.lm)<span class="sc">$</span>r.squared, <span class="dv">3</span>)</span>
<span id="cb184-5"><a href="7-1-the-simple-linear-regression-equation.html#cb184-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-6"><a href="7-1-the-simple-linear-regression-equation.html#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> faithful, <span class="fu">aes</span>(<span class="at">x =</span> waiting, <span class="at">y =</span> eruptions)) <span class="sc">+</span></span>
<span id="cb184-7"><a href="7-1-the-simple-linear-regression-equation.html#cb184-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb184-8"><a href="7-1-the-simple-linear-regression-equation.html#cb184-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;slope == &quot;</span>, slope, <span class="st">&quot;~(min/min)&quot;</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb184-9"><a href="7-1-the-simple-linear-regression-equation.html#cb184-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> <span class="fl">4.75</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;italic(p) &lt; &quot;</span>, p.val), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb184-10"><a href="7-1-the-simple-linear-regression-equation.html#cb184-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;italic(r)^2 == &quot;</span>, r2), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb184-11"><a href="7-1-the-simple-linear-regression-equation.html#cb184-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span></span>
<span id="cb184-12"><a href="7-1-the-simple-linear-regression-equation.html#cb184-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Old Faithful eruption data&quot;</span>,</span>
<span id="cb184-13"><a href="7-1-the-simple-linear-regression-equation.html#cb184-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Linear regression&quot;</span>,</span>
<span id="cb184-14"><a href="7-1-the-simple-linear-regression-equation.html#cb184-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Waiting time (minutes)&quot;</span>,</span>
<span id="cb184-15"><a href="7-1-the-simple-linear-regression-equation.html#cb184-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Eruption duration (minutes)&quot;</span>)</span></code></pre></div>
<p><img src="08-regressions_files/figure-html/lm-plot1-1.png" width="70%" /></p>
</div>
<div id="predicting-from-the-linear-model" class="section level3" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Predicting from the linear model</h3>
<p>Knowing <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> allows us to predict what the eruption duration will be for a certain amount of waiting. Since the slope of the line is positive we can expect that the longer the waiting time is between eruptions the longer the eruption would be. But how can we quantify this? We start by extracting the coefficients (both the intercept and the regression coefficient). Then we use these values to reassemble the regression equation that we have written out above (i.e., <span class="math inline">\(eruption_{n}=\beta \cdot waiting_{n}+\alpha+\epsilon\)</span>). Here’s how:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="7-1-the-simple-linear-regression-equation.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the accessor function to grab the coefficients:</span></span>
<span id="cb185-2"><a href="7-1-the-simple-linear-regression-equation.html#cb185-2" aria-hidden="true" tabindex="-1"></a>erupt.coef <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(eruption.lm)</span>
<span id="cb185-3"><a href="7-1-the-simple-linear-regression-equation.html#cb185-3" aria-hidden="true" tabindex="-1"></a>erupt.coef</span></code></pre></div>
<pre><code>R&gt; (Intercept)     waiting 
R&gt; -1.87401599  0.07562795</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="7-1-the-simple-linear-regression-equation.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how long would an eruption last of we waited, say, 80 minutes?</span></span>
<span id="cb187-2"><a href="7-1-the-simple-linear-regression-equation.html#cb187-2" aria-hidden="true" tabindex="-1"></a>waiting <span class="ot">&lt;-</span> <span class="dv">80</span> </span>
<span id="cb187-3"><a href="7-1-the-simple-linear-regression-equation.html#cb187-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb187-4"><a href="7-1-the-simple-linear-regression-equation.html#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the first and second coef. can be accessed using the </span></span>
<span id="cb187-5"><a href="7-1-the-simple-linear-regression-equation.html#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co"># square bracket notation:</span></span>
<span id="cb187-6"><a href="7-1-the-simple-linear-regression-equation.html#cb187-6" aria-hidden="true" tabindex="-1"></a>erupt.pred <span class="ot">&lt;-</span> erupt.coef[<span class="dv">1</span>] <span class="sc">+</span> (erupt.coef[<span class="dv">2</span>] <span class="sc">*</span> waiting)</span>
<span id="cb187-7"><a href="7-1-the-simple-linear-regression-equation.html#cb187-7" aria-hidden="true" tabindex="-1"></a>erupt.pred <span class="co"># the unit is minutes</span></span></code></pre></div>
<pre><code>R&gt; (Intercept) 
R&gt;     4.17622</code></pre>
<p>The prediction is that, given a waiting time of 80 minutes since the previous eruption, the next eruption will last 4.176 minutes.</p>
<p>There is another way to do this. The <code>predict()</code> function takes a dataframe of values for which we want to predict the duration of the eruption and returns a vector with the waiting times:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="7-1-the-simple-linear-regression-equation.html#cb189-1" aria-hidden="true" tabindex="-1"></a>pred.val <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">waiting =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>))</span>
<span id="cb189-2"><a href="7-1-the-simple-linear-regression-equation.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(eruption.lm, pred.val) <span class="co"># returns waiting time in minutes</span></span></code></pre></div>
<pre><code>R&gt;        1        2        3 
R&gt; 2.663661 4.176220 5.688779</code></pre>
</div>
<div id="the-coefficient-of-determination-r2" class="section level3" number="7.1.5">
<h3><span class="header-section-number">7.1.5</span> The coefficient of determination, <span class="math inline">\(r^{2}\)</span></h3>
<p>The coefficient of determination, the <span class="math inline">\(r^{2}\)</span>, of a linear model is the quotient of the variances of the fitted values, <span class="math inline">\(\hat{y_{i}}\)</span>, and observed values, <span class="math inline">\(y_{i}\)</span>, of the dependent variable. If the mean of the dependent variable is <span class="math inline">\(\bar y\)</span>, then the <span class="math inline">\(r^{2}\)</span> is:</p>
<p><span class="math display">\[r^{2}=\frac{\sum(\hat{y_{i}} - \bar{y})^{2}}{\sum(y_{i} - \bar{y})^{2}}\]</span></p>
<p>In our Old Faithful example, the coefficient of determination is returned together with the summary of the <code>eruption.lm</code> object, but it may also be extracted as:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="7-1-the-simple-linear-regression-equation.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(eruption.lm)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>R&gt; [1] 0.8114608</code></pre>
<p>What does the <span class="math inline">\(r^{2}\)</span> tell us? It tells us the “fraction of variance explained by the model” (from the <code>summary.lm()</code> help file). In other words it is the proportion of variation in the dispersion (variance) of the measured dependent variable, <span class="math inline">\(y\)</span>, that can be predicted from the measured independent variable, <span class="math inline">\(x\)</span> (or variables in the case of multiple regressions). It gives us an indication of how well the observed outcome variable is predicted by the observed influential variable, and in the case of a simple linear regression, the geometric relationship of <span class="math inline">\(y\)</span> on <span class="math inline">\(x\)</span> is a straight line. <span class="math inline">\(r^{2}\)</span> can take values from 0 to 1: a value of 0 tells us that there is absolutely no relationship between the two, whilst a value of 1 shows that there is a perfect fit and a scatter of points to denote the <span class="math inline">\(y\)</span> vs. <span class="math inline">\(x\)</span> relationship will all fall perfectly on a straight line.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="7-1-the-simple-linear-regression-equation.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb193-2"><a href="7-1-the-simple-linear-regression-equation.html#cb193-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb193-3"><a href="7-1-the-simple-linear-regression-equation.html#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">666</span>)</span>
<span id="cb193-4"><a href="7-1-the-simple-linear-regression-equation.html#cb193-4" aria-hidden="true" tabindex="-1"></a>rand.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>n),</span>
<span id="cb193-5"><a href="7-1-the-simple-linear-regression-equation.html#cb193-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>))</span>
<span id="cb193-6"><a href="7-1-the-simple-linear-regression-equation.html#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> rand.df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb193-7"><a href="7-1-the-simple-linear-regression-equation.html#cb193-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb193-8"><a href="7-1-the-simple-linear-regression-equation.html#cb193-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">fill =</span> <span class="st">&quot;turquoise&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb193-9"><a href="7-1-the-simple-linear-regression-equation.html#cb193-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Random normal data&quot;</span>,</span>
<span id="cb193-10"><a href="7-1-the-simple-linear-regression-equation.html#cb193-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Linear regression&quot;</span>,</span>
<span id="cb193-11"><a href="7-1-the-simple-linear-regression-equation.html#cb193-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;X (independent variable)&quot;</span>,</span>
<span id="cb193-12"><a href="7-1-the-simple-linear-regression-equation.html#cb193-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Y (dependent variable)&quot;</span>)</span></code></pre></div>
<p><img src="08-regressions_files/figure-html/lm-plot2-1.png" width="70%" /></p>
<!-- insert a graph of a random relationship of y on x (a fitted line will have have a slope of 0 and the intercept will equal the mean, and the r2 will be 0) -->
<!-- insert a graph of a perfect relationship of y on x, r2 will be 1 -->
<p>Regressions may take on any relationship, not only a linear one. For example, there are parabolic, hyperbolic, logistic, exponential, etc. relationships of <span class="math inline">\(y\)</span> on <span class="math inline">\(x\)</span>, and here, too, does <span class="math inline">\(r^{2}\)</span> tell us the same thing. If we assume that the samples were representatively drawn from a population (i.e. the sample fully captures the relationship of <span class="math inline">\(y\)</span> on <span class="math inline">\(x\)</span> that is present in the entire population), the <span class="math inline">\(r^{2}\)</span> will represent the relationship in the population too.</p>
<!-- maybe give examples of some other mathematical relationships, such as 2nd order polynomial and a sine curve fitted to seasonal data -->
<p>In the case of our Old Faithful data, the <span class="math inline">\(r^{2}\)</span> is 0.811, meaning that the proportion of variance explained is 81.1%; the remaining 18.9% is not (yet) accounted for by the linear relationship. Adding more predictors into the regression (i.e. a multiple regression) might consume some of the unexplained variance and increase the overall <span class="math inline">\(r^{2}\)</span>.</p>
</div>
<div id="significance-test-for-linear-regression" class="section level3" number="7.1.6">
<h3><span class="header-section-number">7.1.6</span> Significance test for linear regression</h3>
<p>There are several hypothesis tests associated with a simple linear regression. All of them assume that the residual error, <span class="math inline">\(\epsilon\)</span>, in the linear regression model is independent of <span class="math inline">\(x\)</span> (i.e. nothing about the structure of the error term can be inferred based on a knowledge of <span class="math inline">\(x\)</span>), is normally distributed, with zero mean and constant variance. We say the residuals are <em>i.i.d.</em> (independent and identically distributed, which is a fancy way of saying they are random).</p>
<p>We can decide whether there is any significant relationship (slope) of <span class="math inline">\(y\)</span> on <span class="math inline">\(x\)</span> by testing the null hypothesis that <span class="math inline">\(\beta=0\)</span>. Rejecting the null hypothesis causes the alternate hypothesis of <span class="math inline">\(\beta \neq 0\)</span> to be accepted. This test is automatically performed when fitting a linear model in R and asking for a summary of the regression object, but it is insightful and important to know that the test is simply a one-sample <em>t</em>-test. In the regression summary the probability associated with this test is given in the <code>Coefficients</code> table in the column called <code>Pr(&gt;|t|)</code>.</p>
<p>In the Old Faithful data, the <em>p</em>-value associated with <code>waiting</code> is less than 0.05 and we therefore reject the null hypothesis that <span class="math inline">\(\beta=0\)</span>. So, there is a significant linear relationship of eruption duration on the waiting time between eruptions.</p>
<blockquote>
<p><strong>Question:</strong> Note that there is also a hypothesis test in the <code>(Intercept)</code> row. What does this do?</p>
</blockquote>
</div>
<div id="confidence-interval-for-linear-regression" class="section level3" number="7.1.7">
<h3><span class="header-section-number">7.1.7</span> Confidence interval for linear regression</h3>
<p>Again we have to observe the assumption of <em>i.i.d.</em> as before. For a given value of <span class="math inline">\(x\)</span>, the 95% confidence interval around the mean of the <em>observed</em> dependent variable, <span class="math inline">\(\bar{y}\)</span>, can be obtained as follows:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="7-1-the-simple-linear-regression-equation.html#cb194-1" aria-hidden="true" tabindex="-1"></a>pred.val <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">waiting =</span> <span class="fu">c</span>(<span class="dv">80</span>))</span>
<span id="cb194-2"><a href="7-1-the-simple-linear-regression-equation.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(eruption.lm, pred.val, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<pre><code>R&gt;       fit      lwr      upr
R&gt; 1 4.17622 4.104848 4.247592</code></pre>
<p>So, the 95% confidence interval of the mean eruption duration for the waiting time of 80 minutes is between 4.105 and 4.248 minutes.</p>
</div>
<div id="prediction-interval-for-linear-regression" class="section level3" number="7.1.8">
<h3><span class="header-section-number">7.1.8</span> Prediction interval for linear regression</h3>
<p>Observe that <span class="math inline">\(\epsilon\)</span> is <em>i.i.d.</em> For a given value of <span class="math inline">\(x\)</span>, the interval estimate of the <em>future</em> dependent variable, <span class="math inline">\(y\)</span>, is called the prediction interval. The way we do this is similar to finding the confidence interval:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="7-1-the-simple-linear-regression-equation.html#cb196-1" aria-hidden="true" tabindex="-1"></a>pred.val <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">waiting =</span> <span class="fu">c</span>(<span class="dv">80</span>))</span>
<span id="cb196-2"><a href="7-1-the-simple-linear-regression-equation.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(eruption.lm, pred.val, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<pre><code>R&gt;       fit      lwr      upr
R&gt; 1 4.17622 3.196089 5.156351</code></pre>
<p>The intervals are wider. The difference between confidence and prediction intervals is subtle and requires some philosophical consideration. In practice, if you use these intervals to make inferences about the population from which the samples were drawn, use the prediction intervals. If you instead want to describe the samples which you have taken, use the confidence intervals.</p>
</div>
<div id="residual-plot" class="section level3" number="7.1.9">
<h3><span class="header-section-number">7.1.9</span> Residual plot</h3>
</div>
<div id="standardised-residual" class="section level3" number="7.1.10">
<h3><span class="header-section-number">7.1.10</span> Standardised residual</h3>
</div>
<div id="normal-probability-plot-of-residuals" class="section level3" number="7.1.11">
<h3><span class="header-section-number">7.1.11</span> Normal probability plot of residuals</h3>
</div>
</div>
<p style="text-align: center;">
<a href="7-simple-linear-regressions.html"><button class="btn btn-default">Previous</button></a>
<a href="7-2-using-an-additional-categorical-variable.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
