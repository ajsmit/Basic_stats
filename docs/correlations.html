<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Correlations | Basic Statistics</title>
  <meta name="description" content="A Book about Basic Statistics." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Correlations | Basic Statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/figures/NSFW.jpg" />
  <meta property="og:description" content="A Book about Basic Statistics." />
  <meta name="github-repo" content="ajsmit/Basic_stats" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Correlations | Basic Statistics" />
  
  <meta name="twitter:description" content="A Book about Basic Statistics." />
  <meta name="twitter:image" content="/figures/NSFW.jpg" />

<meta name="author" content="AJ Smit and Robert Schlegel" />


<meta name="date" content="2021-07-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-linear-regressions.html"/>
<link rel="next" href="confidence-intervals.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#venue-date-and-time"><i class="fa fa-check"></i><b>1.1</b> Venue, date and time</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#course-outline"><i class="fa fa-check"></i><b>1.2</b> Course outline</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#about-this-workshop"><i class="fa fa-check"></i><b>1.3</b> About this Workshop</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#this-is-biology-why-more-r-coding"><i class="fa fa-check"></i><b>1.4</b> This is biology: why more R coding?</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.5</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#resources"><i class="fa fa-check"></i><b>1.6</b> Resources</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#style-and-code-conventions"><i class="fa fa-check"></i><b>1.7</b> Style and code conventions</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#assessment-and-teaching-philosophy"><i class="fa fa-check"></i><b>1.8</b> Assessment and teaching philosophy</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#about-this-document"><i class="fa fa-check"></i><b>1.9</b> About this document</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="types-of-data.html"><a href="types-of-data.html"><i class="fa fa-check"></i><b>2</b> Types of data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="types-of-data.html"><a href="types-of-data.html#data-classes"><i class="fa fa-check"></i><b>2.1</b> Data classes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="types-of-data.html"><a href="types-of-data.html#numerical-data"><i class="fa fa-check"></i><b>2.1.1</b> Numerical data</a></li>
<li class="chapter" data-level="2.1.2" data-path="types-of-data.html"><a href="types-of-data.html#qualitative-data"><i class="fa fa-check"></i><b>2.1.2</b> Qualitative data</a></li>
<li class="chapter" data-level="2.1.3" data-path="types-of-data.html"><a href="types-of-data.html#binary-data"><i class="fa fa-check"></i><b>2.1.3</b> Binary data</a></li>
<li class="chapter" data-level="2.1.4" data-path="types-of-data.html"><a href="types-of-data.html#character-values"><i class="fa fa-check"></i><b>2.1.4</b> Character values</a></li>
<li class="chapter" data-level="2.1.5" data-path="types-of-data.html"><a href="types-of-data.html#missing-values"><i class="fa fa-check"></i><b>2.1.5</b> Missing values</a></li>
<li class="chapter" data-level="2.1.6" data-path="types-of-data.html"><a href="types-of-data.html#complex-numbers"><i class="fa fa-check"></i><b>2.1.6</b> Complex numbers</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="types-of-data.html"><a href="types-of-data.html#viewing-our-data"><i class="fa fa-check"></i><b>2.2</b> Viewing our data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="types-of-data.html"><a href="types-of-data.html#from-the-environment-pane"><i class="fa fa-check"></i><b>2.2.1</b> From the Environment pane</a></li>
<li class="chapter" data-level="2.2.2" data-path="types-of-data.html"><a href="types-of-data.html#head-and-tail"><i class="fa fa-check"></i><b>2.2.2</b> <code>head()</code> and <code>tail()</code></a></li>
<li class="chapter" data-level="2.2.3" data-path="types-of-data.html"><a href="types-of-data.html#colnames"><i class="fa fa-check"></i><b>2.2.3</b> <code>colnames()</code></a></li>
<li class="chapter" data-level="2.2.4" data-path="types-of-data.html"><a href="types-of-data.html#summary"><i class="fa fa-check"></i><b>2.2.4</b> <code>summary()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html"><i class="fa fa-check"></i><b>3</b> Descriptive statistics: central tendency and dispersion</a>
<ul>
<li class="chapter" data-level="3.1" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#samples-and-populations"><i class="fa fa-check"></i><b>3.1</b> Samples and populations</a></li>
<li class="chapter" data-level="3.2" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>3.2</b> Measures of central tendency</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#the-mean"><i class="fa fa-check"></i><b>3.2.1</b> The mean</a></li>
<li class="chapter" data-level="3.2.2" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#the-median"><i class="fa fa-check"></i><b>3.2.2</b> The median</a></li>
<li class="chapter" data-level="3.2.3" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#skewness"><i class="fa fa-check"></i><b>3.2.3</b> Skewness</a></li>
<li class="chapter" data-level="3.2.4" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#kurtosis"><i class="fa fa-check"></i><b>3.2.4</b> Kurtosis</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#measures-of-variation-and-spread"><i class="fa fa-check"></i><b>3.3</b> Measures of variation and spread</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#the-variance-and-standard-deviation"><i class="fa fa-check"></i><b>3.3.1</b> The variance and standard deviation</a></li>
<li class="chapter" data-level="3.3.2" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#quantiles"><i class="fa fa-check"></i><b>3.3.2</b> Quantiles</a></li>
<li class="chapter" data-level="3.3.3" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#the-minimum-maximum-and-range"><i class="fa fa-check"></i><b>3.3.3</b> The minimum, maximum and range</a></li>
<li class="chapter" data-level="3.3.4" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#covariance"><i class="fa fa-check"></i><b>3.3.4</b> Covariance</a></li>
<li class="chapter" data-level="3.3.5" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#correlation"><i class="fa fa-check"></i><b>3.3.5</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#missing-values-1"><i class="fa fa-check"></i><b>3.4</b> Missing values</a></li>
<li class="chapter" data-level="3.5" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#descriptive-statistics-by-group"><i class="fa fa-check"></i><b>3.5</b> Descriptive statistics by group</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#groupwise-summary-statistics"><i class="fa fa-check"></i><b>3.5.1</b> Groupwise summary statistics</a></li>
<li class="chapter" data-level="3.5.2" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#displays-of-group-summaries"><i class="fa fa-check"></i><b>3.5.2</b> Displays of group summaries</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#exercises"><i class="fa fa-check"></i><b>3.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="descriptive-statistics-central-tendency-and-dispersion.html"><a href="descriptive-statistics-central-tendency-and-dispersion.html#exercise-1"><i class="fa fa-check"></i><b>3.6.1</b> Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html"><i class="fa fa-check"></i><b>4</b> Graphical data displays</a>
<ul>
<li class="chapter" data-level="4.1" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#qualitative-data-1"><i class="fa fa-check"></i><b>4.1</b> Qualitative data</a></li>
<li class="chapter" data-level="4.2" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#continuous-data-1"><i class="fa fa-check"></i><b>4.2</b> Continuous data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#frequency-distributions-histograms"><i class="fa fa-check"></i><b>4.2.1</b> Frequency distributions (histograms)</a></li>
<li class="chapter" data-level="4.2.2" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#box-plots"><i class="fa fa-check"></i><b>4.2.2</b> Box plots</a></li>
<li class="chapter" data-level="4.2.3" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#pairwise-scatter-plots"><i class="fa fa-check"></i><b>4.2.3</b> Pairwise Scatter plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#bar-graphs"><i class="fa fa-check"></i><b>4.2.4</b> Bar graphs</a></li>
<li class="chapter" data-level="4.2.5" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#density-graphs"><i class="fa fa-check"></i><b>4.2.5</b> Density graphs</a></li>
<li class="chapter" data-level="4.2.6" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#violin-plots"><i class="fa fa-check"></i><b>4.2.6</b> Violin plots</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#exercises-1"><i class="fa fa-check"></i><b>4.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="graphical-data-displays.html"><a href="graphical-data-displays.html#exercise-1-1"><i class="fa fa-check"></i><b>4.3.1</b> Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html"><i class="fa fa-check"></i><b>5</b> Inferences about one or two populations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#what-are-probabilities"><i class="fa fa-check"></i><b>5.1</b> What are probabilities?</a></li>
<li class="chapter" data-level="5.2" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#is-there-a-difference-between-two-groups"><i class="fa fa-check"></i><b>5.2</b> Is there a difference between two groups?</a></li>
<li class="chapter" data-level="5.3" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#assumptions"><i class="fa fa-check"></i><b>5.3</b> Assumptions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#normality"><i class="fa fa-check"></i><b>5.3.1</b> Normality</a></li>
<li class="chapter" data-level="5.3.2" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#homoscedasticity"><i class="fa fa-check"></i><b>5.3.2</b> Homoscedasticity</a></li>
<li class="chapter" data-level="5.3.3" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#two-for-one"><i class="fa fa-check"></i><b>5.3.3</b> Two for one</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#one-sample-t-tests"><i class="fa fa-check"></i><b>5.4</b> One-sample <em>t</em>-tests</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#one-sided-one-sample-t-tests"><i class="fa fa-check"></i><b>5.4.1</b> One-sided one-sample <em>t</em>-tests</a></li>
<li class="chapter" data-level="5.4.2" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#two-sided-one-sample-t-tests"><i class="fa fa-check"></i><b>5.4.2</b> Two-sided one-sample <em>t</em>-tests</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#two-sample-t-tests"><i class="fa fa-check"></i><b>5.5</b> Two-sample <em>t</em>-tests</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#one-sided-two-sample-t-tests"><i class="fa fa-check"></i><b>5.5.1</b> One-sided two-sample <em>t</em>-tests</a></li>
<li class="chapter" data-level="5.5.2" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#two-sided-two-sample-t-tests"><i class="fa fa-check"></i><b>5.5.2</b> Two-sided two-sample <em>t</em>-tests</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#paired-t-tests"><i class="fa fa-check"></i><b>5.6</b> Paired <em>t</em>-tests</a></li>
<li class="chapter" data-level="5.7" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#comparison-of-two-population-proportions"><i class="fa fa-check"></i><b>5.7</b> Comparison of two population proportions</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#one-sample-and-two-sample-tests"><i class="fa fa-check"></i><b>5.7.1</b> One-sample and two-sample tests</a></li>
<li class="chapter" data-level="5.7.2" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#one-sided-and-two-sided-tests"><i class="fa fa-check"></i><b>5.7.2</b> One-sided and two-sided tests</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#a-t-test-workflow"><i class="fa fa-check"></i><b>5.8</b> A <em>t</em>-test workflow</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#loading-data"><i class="fa fa-check"></i><b>5.8.1</b> Loading data</a></li>
<li class="chapter" data-level="5.8.2" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#visualising-data"><i class="fa fa-check"></i><b>5.8.2</b> Visualising data</a></li>
<li class="chapter" data-level="5.8.3" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#formulating-a-hypothesis"><i class="fa fa-check"></i><b>5.8.3</b> Formulating a hypothesis</a></li>
<li class="chapter" data-level="5.8.4" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#choosing-a-test"><i class="fa fa-check"></i><b>5.8.4</b> Choosing a test</a></li>
<li class="chapter" data-level="5.8.5" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#checking-assumptions"><i class="fa fa-check"></i><b>5.8.5</b> Checking assumptions</a></li>
<li class="chapter" data-level="5.8.6" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#running-an-analysis"><i class="fa fa-check"></i><b>5.8.6</b> Running an analysis</a></li>
<li class="chapter" data-level="5.8.7" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#interpreting-the-results"><i class="fa fa-check"></i><b>5.8.7</b> Interpreting the results</a></li>
<li class="chapter" data-level="5.8.8" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#drawing-conclusions"><i class="fa fa-check"></i><b>5.8.8</b> Drawing conclusions</a></li>
<li class="chapter" data-level="5.8.9" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#going-further"><i class="fa fa-check"></i><b>5.8.9</b> Going further</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#exercises-2"><i class="fa fa-check"></i><b>5.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#exercise-1-2"><i class="fa fa-check"></i><b>5.9.1</b> Exercise 1</a></li>
<li class="chapter" data-level="5.9.2" data-path="inferences-about-one-or-two-populations.html"><a href="inferences-about-one-or-two-populations.html#exercise-2"><i class="fa fa-check"></i><b>5.9.2</b> Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>6</b> ANOVA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="anova.html"><a href="anova.html#remember-the-t-test"><i class="fa fa-check"></i><b>6.1</b> Remember the <em>t</em>-test</a></li>
<li class="chapter" data-level="6.2" data-path="anova.html"><a href="anova.html#anova-1"><i class="fa fa-check"></i><b>6.2</b> ANOVA</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="anova.html"><a href="anova.html#single-factor"><i class="fa fa-check"></i><b>6.2.1</b> Single factor</a></li>
<li class="chapter" data-level="6.2.2" data-path="anova.html"><a href="anova.html#multiple-factors"><i class="fa fa-check"></i><b>6.2.2</b> Multiple factors</a></li>
<li class="chapter" data-level="6.2.3" data-path="anova.html"><a href="anova.html#examples"><i class="fa fa-check"></i><b>6.2.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="anova.html"><a href="anova.html#alternatives-to-anova"><i class="fa fa-check"></i><b>6.3</b> Alternatives to ANOVA</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="anova.html"><a href="anova.html#wilcox-rank-sum-test"><i class="fa fa-check"></i><b>6.3.1</b> Wilcox rank sum test</a></li>
<li class="chapter" data-level="6.3.2" data-path="anova.html"><a href="anova.html#kruskall-wallis-rank-sum-test"><i class="fa fa-check"></i><b>6.3.2</b> Kruskall-Wallis rank sum test</a></li>
<li class="chapter" data-level="6.3.3" data-path="anova.html"><a href="anova.html#the-sa-time-data"><i class="fa fa-check"></i><b>6.3.3</b> The SA time data</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="anova.html"><a href="anova.html#exercises-3"><i class="fa fa-check"></i><b>6.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="anova.html"><a href="anova.html#exercise-1-3"><i class="fa fa-check"></i><b>6.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="6.4.2" data-path="anova.html"><a href="anova.html#exercise-2-1"><i class="fa fa-check"></i><b>6.4.2</b> Exercise 2</a></li>
<li class="chapter" data-level="6.4.3" data-path="anova.html"><a href="anova.html#exercise-3"><i class="fa fa-check"></i><b>6.4.3</b> Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html"><i class="fa fa-check"></i><b>7</b> Simple linear regressions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#the-simple-linear-regression-equation"><i class="fa fa-check"></i><b>7.1</b> The simple linear regression equation</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#the-intercept"><i class="fa fa-check"></i><b>7.1.1</b> The intercept</a></li>
<li class="chapter" data-level="7.1.2" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#the-regression-coefficient"><i class="fa fa-check"></i><b>7.1.2</b> The regression coefficient</a></li>
<li class="chapter" data-level="7.1.3" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#a-graph-of-the-linear-regression"><i class="fa fa-check"></i><b>7.1.3</b> A graph of the linear regression</a></li>
<li class="chapter" data-level="7.1.4" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#predicting-from-the-linear-model"><i class="fa fa-check"></i><b>7.1.4</b> Predicting from the linear model</a></li>
<li class="chapter" data-level="7.1.5" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#the-coefficient-of-determination-r2"><i class="fa fa-check"></i><b>7.1.5</b> The coefficient of determination, <span class="math inline">\(r^{2}\)</span></a></li>
<li class="chapter" data-level="7.1.6" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#significance-test-for-linear-regression"><i class="fa fa-check"></i><b>7.1.6</b> Significance test for linear regression</a></li>
<li class="chapter" data-level="7.1.7" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#confidence-interval-for-linear-regression"><i class="fa fa-check"></i><b>7.1.7</b> Confidence interval for linear regression</a></li>
<li class="chapter" data-level="7.1.8" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#prediction-interval-for-linear-regression"><i class="fa fa-check"></i><b>7.1.8</b> Prediction interval for linear regression</a></li>
<li class="chapter" data-level="7.1.9" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#residual-plot"><i class="fa fa-check"></i><b>7.1.9</b> Residual plot</a></li>
<li class="chapter" data-level="7.1.10" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#standardised-residual"><i class="fa fa-check"></i><b>7.1.10</b> Standardised residual</a></li>
<li class="chapter" data-level="7.1.11" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#normal-probability-plot-of-residuals"><i class="fa fa-check"></i><b>7.1.11</b> Normal probability plot of residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="simple-linear-regressions.html"><a href="simple-linear-regressions.html#using-an-additional-categorical-variable"><i class="fa fa-check"></i><b>7.2</b> Using an additional categorical variable</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i><b>8</b> Correlations</a>
<ul>
<li class="chapter" data-level="8.1" data-path="correlations.html"><a href="correlations.html#pearson-correlation"><i class="fa fa-check"></i><b>8.1</b> Pearson correlation</a></li>
<li class="chapter" data-level="8.2" data-path="correlations.html"><a href="correlations.html#spearman-rank-correlation"><i class="fa fa-check"></i><b>8.2</b> Spearman rank correlation</a></li>
<li class="chapter" data-level="8.3" data-path="correlations.html"><a href="correlations.html#kendall-rank-correlation"><i class="fa fa-check"></i><b>8.3</b> Kendall rank correlation</a></li>
<li class="chapter" data-level="8.4" data-path="correlations.html"><a href="correlations.html#one-panel-visual"><i class="fa fa-check"></i><b>8.4</b> One panel visual</a></li>
<li class="chapter" data-level="8.5" data-path="correlations.html"><a href="correlations.html#multiple-panel-visual"><i class="fa fa-check"></i><b>8.5</b> Multiple panel visual</a></li>
<li class="chapter" data-level="8.6" data-path="correlations.html"><a href="correlations.html#exercises-4"><i class="fa fa-check"></i><b>8.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="correlations.html"><a href="correlations.html#exercise-1-4"><i class="fa fa-check"></i><b>8.6.1</b> Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>9</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#calculating-confidence"><i class="fa fa-check"></i><b>9.1</b> Calculating confidence</a></li>
<li class="chapter" data-level="9.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#ci-of-compared-means"><i class="fa fa-check"></i><b>9.2</b> CI of compared means</a></li>
<li class="chapter" data-level="9.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#harrell-plots"><i class="fa fa-check"></i><b>9.3</b> Harrell plots</a></li>
<li class="chapter" data-level="9.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#exercises-5"><i class="fa fa-check"></i><b>9.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#exercise-1-5"><i class="fa fa-check"></i><b>9.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="9.4.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#exercise-2-2"><i class="fa fa-check"></i><b>9.4.2</b> Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><i class="fa fa-check"></i><b>10</b> Testing assumptions or: How I learned to stop worrying and transform the data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#backgroud"><i class="fa fa-check"></i><b>10.1</b> Backgroud</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#normality-1"><i class="fa fa-check"></i><b>10.1.1</b> Normality</a></li>
<li class="chapter" data-level="10.1.2" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#homoscedasticity-1"><i class="fa fa-check"></i><b>10.1.2</b> Homoscedasticity</a></li>
<li class="chapter" data-level="10.1.3" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#epic-fail.-now-what"><i class="fa fa-check"></i><b>10.1.3</b> Epic fail. Now what?</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#transforming-data"><i class="fa fa-check"></i><b>10.2</b> Transforming data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#log-transform"><i class="fa fa-check"></i><b>10.2.1</b> Log transform</a></li>
<li class="chapter" data-level="10.2.2" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#arcsine-transform"><i class="fa fa-check"></i><b>10.2.2</b> Arcsine transform</a></li>
<li class="chapter" data-level="10.2.3" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#cube-root"><i class="fa fa-check"></i><b>10.2.3</b> Cube root</a></li>
<li class="chapter" data-level="10.2.4" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#square-root-transform"><i class="fa fa-check"></i><b>10.2.4</b> Square root transform</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#exercises-6"><i class="fa fa-check"></i><b>10.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#exercise-1-6"><i class="fa fa-check"></i><b>10.3.1</b> Exercise 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html"><a href="testing-assumptions-or-how-i-learned-to-stop-worrying-and-transform-the-data.html#exercise-2-3"><i class="fa fa-check"></i><b>10.3.2</b> Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>11</b> Linear mixed models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#wilcox-rank-sum-test-1"><i class="fa fa-check"></i><b>11.1</b> Wilcox rank sum test</a></li>
<li class="chapter" data-level="11.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#kruskall-wallis-rank-sum-test-1"><i class="fa fa-check"></i><b>11.2</b> Kruskall-Wallis rank sum test</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#single-factor-2"><i class="fa fa-check"></i><b>11.2.1</b> Single factor</a></li>
<li class="chapter" data-level="11.2.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#multiple-factors-2"><i class="fa fa-check"></i><b>11.2.2</b> Multiple factors</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#generalised-linear-models"><i class="fa fa-check"></i><b>11.3</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#sign-test"><i class="fa fa-check"></i><b>11.3.1</b> Sign Test</a></li>
<li class="chapter" data-level="11.3.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>11.3.2</b> Wilcoxon Signed-Rank Test</a></li>
<li class="chapter" data-level="11.3.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#mann-whitney-wilcoxon-test"><i class="fa fa-check"></i><b>11.3.3</b> Mann-Whitney-Wilcoxon Test</a></li>
<li class="chapter" data-level="11.3.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>11.3.4</b> Kruskal-Wallis Test</a></li>
<li class="chapter" data-level="11.3.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#generalised-linear-models-glm"><i class="fa fa-check"></i><b>11.3.5</b> Generalised linear models (GLM)</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#exercises-7"><i class="fa fa-check"></i><b>11.4</b> Exercises</a></li>
<li class="chapter" data-level="11.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#exercise-1-7"><i class="fa fa-check"></i><b>11.5</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chi-squared.html"><a href="chi-squared.html"><i class="fa fa-check"></i><b>12</b> Chi-squared</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Basic Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="correlations" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Correlations</h1>
<p>A correlation is performed when we want to investigate potential relationships between variables from the same sample. This does not mean that one variable explains the other, we arrive at that through the use of regression, as seen in Chapter 8. Like all statistical tests, correlation requires a series of assumptions as well:</p>
<ul>
<li>pair-wise data</li>
<li>absence of outliers</li>
<li>linearity</li>
<li>normality of distribution</li>
<li>homoscedasticity</li>
<li>level (type) of measurement
<ul>
<li>Continuous data (Pearson correlation)</li>
<li>Ordinal data (Spearman correlation)</li>
</ul></li>
</ul>
<p>In order to investigate correlations in biological data lets load the <code>ecklonia</code> dataset.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="correlations.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb198-2"><a href="correlations.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb198-3"><a href="correlations.html#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb198-4"><a href="correlations.html#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb198-5"><a href="correlations.html#cb198-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-6"><a href="correlations.html#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb198-7"><a href="correlations.html#cb198-7" aria-hidden="true" tabindex="-1"></a>ecklonia <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/ecklonia.csv&quot;</span>)</span></code></pre></div>
<p>We will also create a subsetted version of our data by removing all of the categorical variables. If we have a dataframe where each column represents pair-wise continuous/ordinal measurements with all of the other columns we may very quickly and easily perform a much wider range of correlation analyses.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="correlations.html#cb199-1" aria-hidden="true" tabindex="-1"></a>ecklonia_sub <span class="ot">&lt;-</span> ecklonia <span class="sc">%&gt;%</span> </span>
<span id="cb199-2"><a href="correlations.html#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>species, <span class="sc">-</span> site, <span class="sc">-</span> ID)</span></code></pre></div>
<div id="pearson-correlation" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Pearson correlation</h2>
<p>When the values we are comparing are continuous, we may use a Pearson test. This is the default and so requires little work on our end. The resulting statistic from this test is known as the correlation coefficient.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="correlations.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform correlation analysis on two specific variables</span></span>
<span id="cb200-2"><a href="correlations.html#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Note that we do not need the final two arguments in this function to be stated</span></span>
<span id="cb200-3"><a href="correlations.html#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># as they are the defaut settings.</span></span>
<span id="cb200-4"><a href="correlations.html#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># They are only shown here to illustrate that they exist.</span></span>
<span id="cb200-5"><a href="correlations.html#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> ecklonia<span class="sc">$</span>stipe_length, ecklonia<span class="sc">$</span>frond_length,</span>
<span id="cb200-6"><a href="correlations.html#cb200-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span> <span class="st">&quot;everything&quot;</span>, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>R&gt; 
R&gt;  Pearson&#39;s product-moment correlation
R&gt; 
R&gt; data:  ecklonia$stipe_length and ecklonia$frond_length
R&gt; t = 4.2182, df = 24, p-value = 0.0003032
R&gt; alternative hypothesis: true correlation is not equal to 0
R&gt; 95 percent confidence interval:
R&gt;  0.3548169 0.8300525
R&gt; sample estimates:
R&gt;       cor 
R&gt; 0.6524911</code></pre>
<p>Above we have tested the correlation between the length of <em>Ecklonia maxima</em> stipes and the length of their fronds. A perfect positive (negative) relationship would produce a value of 1 (-1), whereas no relationship would produce a value of 0. The result above, <code>cor = 0.65</code> is relatively strong. That being said, should our dataset contain multiple variables, as <code>ecklonia</code> does, we may investigate all of the correlations simultaneously. Remember that in order to do so we want to ensure that we may perform the same test on each of our paired variables. In this case we will use <code>ecklonia_sub</code> as we know that it contains only continuous data and so are appropriate for use with a Pearson test. By default R will use all of the data we give it and perform a Pearson test so we do not need to specify any further arguments. Note however that this will only output the correlation coefficients, and does not produce a full test of each correlation. This will however be useful for us to have just now.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="correlations.html#cb202-1" aria-hidden="true" tabindex="-1"></a>ecklonia_pearson <span class="ot">&lt;-</span> <span class="fu">cor</span>(ecklonia_sub)</span>
<span id="cb202-2"><a href="correlations.html#cb202-2" aria-hidden="true" tabindex="-1"></a>ecklonia_pearson</span></code></pre></div>
<pre><code>R&gt;                      stipe_length stipe_diameter frond_length     digits
R&gt; stipe_length            1.0000000      0.5853577   0.65249111 0.24273818
R&gt; stipe_diameter          0.5853577      1.0000000   0.39032107 0.24098021
R&gt; frond_length            0.6524911      0.3903211   1.00000000 0.35604257
R&gt; digits                  0.2427382      0.2409802   0.35604257 1.00000000
R&gt; primary_blade_width     0.3413692      0.8269196   0.28307223 0.13954003
R&gt; primary_blade_length    0.1330329      0.3176688  -0.01584175 0.09784266
R&gt; stipe_mass              0.5768102      0.8226091   0.39471926 0.06958775
R&gt; frond_mass              0.5124551      0.5066763   0.56762418 0.28162375
R&gt; epiphyte_length         0.6056152      0.5372470   0.61489806 0.04634642
R&gt;                      primary_blade_width primary_blade_length stipe_mass
R&gt; stipe_length                   0.3413692           0.13303292 0.57681018
R&gt; stipe_diameter                 0.8269196           0.31766879 0.82260910
R&gt; frond_length                   0.2830722          -0.01584175 0.39471926
R&gt; digits                         0.1395400           0.09784266 0.06958775
R&gt; primary_blade_width            1.0000000           0.33931061 0.82745162
R&gt; primary_blade_length           0.3393106           1.00000000 0.16175948
R&gt; stipe_mass                     0.8274516           0.16175948 1.00000000
R&gt; frond_mass                     0.3630630           0.14729132 0.47195130
R&gt; epiphyte_length                0.4119969           0.26051399 0.50790877
R&gt;                      frond_mass epiphyte_length
R&gt; stipe_length          0.5124551      0.60561520
R&gt; stipe_diameter        0.5066763      0.53724704
R&gt; frond_length          0.5676242      0.61489806
R&gt; digits                0.2816237      0.04634642
R&gt; primary_blade_width   0.3630630      0.41199691
R&gt; primary_blade_length  0.1472913      0.26051399
R&gt; stipe_mass            0.4719513      0.50790877
R&gt; frond_mass            1.0000000      0.43920289
R&gt; epiphyte_length       0.4392029      1.00000000</code></pre>
<blockquote>
<p><strong>Task:</strong> What does the outcome of this test show?</p>
</blockquote>
</div>
<div id="spearman-rank-correlation" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Spearman rank correlation</h2>
<p>When the data we want to compare are not continuous, but rather ordinal, we will need to use a Spearman test. This is not often a test one uses in biology because we tend to want to compare continuous data within categories. In the code below we will add a column of ordinal data to our <code>ecklonia</code> data to so that we may look at this test.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="correlations.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ordinal data</span></span>
<span id="cb204-2"><a href="correlations.html#cb204-2" aria-hidden="true" tabindex="-1"></a>ecklonia<span class="sc">$</span>length <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">cut</span>((ecklonia<span class="sc">$</span>stipe_length<span class="sc">+</span>ecklonia<span class="sc">$</span>frond_length), <span class="at">breaks =</span> <span class="dv">3</span>))</span>
<span id="cb204-3"><a href="correlations.html#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="correlations.html#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run test on any variable</span></span>
<span id="cb204-5"><a href="correlations.html#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ecklonia<span class="sc">$</span>length, ecklonia<span class="sc">$</span>digits)</span></code></pre></div>
<pre><code>R&gt; 
R&gt;  Pearson&#39;s product-moment correlation
R&gt; 
R&gt; data:  ecklonia$length and ecklonia$digits
R&gt; t = 1.4979, df = 24, p-value = 0.1472
R&gt; alternative hypothesis: true correlation is not equal to 0
R&gt; 95 percent confidence interval:
R&gt;  -0.1070908  0.6105880
R&gt; sample estimates:
R&gt;     cor 
R&gt; 0.29239</code></pre>
<blockquote>
<p><strong>Task:</strong> How else might we use this?</p>
</blockquote>
</div>
<div id="kendall-rank-correlation" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Kendall rank correlation</h2>
<p>This test will work for both continuous and ordinal data. A sort of dealers choice of correlation tests. It’s main purpose is to allow us to perform a correlation on non-normally distributed data. Let’s look at the normality of our <code>ecklonia</code> variables and pull out those that are not normal in order to see how the results of this test may differ from our Pearson tests.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="correlations.html#cb206-1" aria-hidden="true" tabindex="-1"></a>ecklonia_norm <span class="ot">&lt;-</span> ecklonia_sub <span class="sc">%&gt;%</span> </span>
<span id="cb206-2"><a href="correlations.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-3"><a href="correlations.html#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span> </span>
<span id="cb206-4"><a href="correlations.html#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">variable_norm =</span> <span class="fu">as.numeric</span>(<span class="fu">shapiro.test</span>(value)[<span class="dv">2</span>]))</span>
<span id="cb206-5"><a href="correlations.html#cb206-5" aria-hidden="true" tabindex="-1"></a>ecklonia_norm</span></code></pre></div>
<pre><code>R&gt; # A tibble: 9 x 2
R&gt;   variable             variable_norm
R&gt;   &lt;chr&gt;                        &lt;dbl&gt;
R&gt; 1 digits                     0.0671 
R&gt; 2 epiphyte_length            0.626  
R&gt; 3 frond_length               0.202  
R&gt; 4 frond_mass                 0.277  
R&gt; 5 primary_blade_length       0.00393
R&gt; 6 primary_blade_width        0.314  
R&gt; 7 stipe_diameter             0.170  
R&gt; 8 stipe_length               0.213  
R&gt; 9 stipe_mass                 0.817</code></pre>
<p>From this analysis we may see that the values for primary blade length are not normally distributed. In order to make up for this violation of our assumption of normality we may use the Spearman test.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="correlations.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(ecklonia<span class="sc">$</span>primary_blade_length, ecklonia<span class="sc">$</span>primary_blade_width, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>R&gt; 
R&gt;  Kendall&#39;s rank correlation tau
R&gt; 
R&gt; data:  ecklonia$primary_blade_length and ecklonia$primary_blade_width
R&gt; z = 2.3601, p-value = 0.01827
R&gt; alternative hypothesis: true tau is not equal to 0
R&gt; sample estimates:
R&gt;       tau 
R&gt; 0.3426171</code></pre>
</div>
<div id="one-panel-visual" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> One panel visual</h2>
<p>As is the case with everything else we have learned thus far, a good visualisation can go a long way to help us understand what the statistics are doing. Below we visualise the stipe length to frond length relationship.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="correlations.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pearson r beforehand for plotting</span></span>
<span id="cb210-2"><a href="correlations.html#cb210-2" aria-hidden="true" tabindex="-1"></a>r_print <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;r = &quot;</span>, </span>
<span id="cb210-3"><a href="correlations.html#cb210-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(<span class="fu">cor</span>(<span class="at">x =</span> ecklonia<span class="sc">$</span>stipe_length, ecklonia<span class="sc">$</span>frond_length),<span class="dv">2</span>))</span>
<span id="cb210-4"><a href="correlations.html#cb210-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-5"><a href="correlations.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Then create a single panel showing one correlation</span></span>
<span id="cb210-6"><a href="correlations.html#cb210-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecklonia, <span class="fu">aes</span>(<span class="at">x =</span> stipe_length, <span class="at">y =</span> frond_length)) <span class="sc">+</span></span>
<span id="cb210-7"><a href="correlations.html#cb210-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb210-8"><a href="correlations.html#cb210-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;mediumorchid4&quot;</span>) <span class="sc">+</span></span>
<span id="cb210-9"><a href="correlations.html#cb210-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">x =</span> <span class="dv">300</span>, <span class="at">y =</span> <span class="dv">240</span>, <span class="at">label =</span> r_print) <span class="sc">+</span></span>
<span id="cb210-10"><a href="correlations.html#cb210-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Stipe length (cm)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Frond length (cm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb210-11"><a href="correlations.html#cb210-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()</span></code></pre></div>
<div class="figure"><span id="fig:corr-plot1"></span>
<img src="09-correlations_files/figure-html/corr-plot1-1.png" alt="Scatterplot showing relationship between _Ecklonia maxima_ stipe length (cm) and frond length (cm). The correlation coefficient (Pearson r) is shown in the top left corner. Note that the grey line running through the middle is a fitted linear model and is not generating the correlation value. Rather it is included to help visually demonstrate the strength of the relationship." width="70%" />
<p class="caption">
Figure 8.1: Scatterplot showing relationship between <em>Ecklonia maxima</em> stipe length (cm) and frond length (cm). The correlation coefficient (Pearson r) is shown in the top left corner. Note that the grey line running through the middle is a fitted linear model and is not generating the correlation value. Rather it is included to help visually demonstrate the strength of the relationship.
</p>
</div>
<p>Just by eye-balling this scatterplot it should be clear that these data tend to increase at a roughly similar rate. Our Pearson r value is an indication of what that is.</p>
</div>
<div id="multiple-panel-visual" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Multiple panel visual</h2>
<p>But why stop at one panel? It is relatively straightforward to quickly plot correlation results for all of our variables in one go. In order to show which variables correlate most with which other variables all at once, without creating chaos, we will create what is known as a heat map. This visualisation uses a range of colours, usually blue to red, to demonstrate where more of something is. In this case, we use it to show where more correlation is occurring between morphometric properties of the kelp <em>Ecklonia maxima</em>.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="correlations.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(ecklonia_pearson, <span class="at">method =</span> <span class="st">&quot;circle&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:corr-plot2"></span>
<img src="09-correlations_files/figure-html/corr-plot2-1.png" alt="Correlation plot showing the strength of all correlations between all variables as a scale from red (negative) to blue (positive)." width="70%" />
<p class="caption">
Figure 8.2: Correlation plot showing the strength of all correlations between all variables as a scale from red (negative) to blue (positive).
</p>
</div>
<blockquote>
<p><strong>Task:</strong> What does the series of dark blue circles through the middle of this plot mean?</p>
<p>&lt; <strong>Task:</strong> Which morphometric properties correlate best/worst?</p>
</blockquote>
<p>Slightly more involved, but much more useful, is the generation of a heat map using <strong><code>ggplot2</code></strong>.</p>
</div>
<div id="exercises-4" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Exercises</h2>
<div id="exercise-1-4" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Exercise 1</h3>
<p>Produce a heat map using <strong><code>ggplot2</code></strong>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-linear-regressions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="confidence-intervals.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true,
"sharing": {
"facebook": false,
"twitter": false,
"google": true
}
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
